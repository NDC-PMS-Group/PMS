import{u as V,P as ee}from"./accessSettings-DVvsW_Yv.js";import{c as te,d as A,o,f as d,b as e,e as u,h as w,P as L,g as k,i as C,F as B,m as T,t as v,W as I,V as _,X as D,j as $,I as X,Y as K,T as G,x as P,y as N,R as U,a as S,n as z,l as se,Z as re,v as O}from"./index-BGKEJEuu.js";import{u as W,S as F}from"./usePermission-CYqkqYTp.js";import{S as oe}from"./shield-DVI2KD-N.js";/**
 * @license lucide-vue-next v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y=te("KeyIcon",[["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["path",{d:"m15.5 7.5 3 3L22 7l-3-3",key:"1rn1fs"}]]),ae={class:"space-y-4"},le={class:"flex justify-between items-center"},de={class:"bg-white dark:bg-gray-800 rounded-lg shadow overflow-hidden"},ne={class:"overflow-auto"},ie={class:"min-w-full divide-y divide-gray-200 dark:divide-gray-700"},ce={class:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700"},ue={key:0},ge={key:1},ye={class:"px-6 py-4 whitespace-nowrap"},xe={class:"text-sm font-medium text-gray-900 dark:text-white"},pe={class:"px-6 py-4"},me={class:"text-sm text-gray-600 dark:text-gray-400"},be={class:"px-6 py-4 whitespace-nowrap"},ke={key:0,class:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-gray-100 dark:bg-gray-700 text-gray-800 dark:text-gray-300"},ve={key:1,class:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 dark:bg-green-900 text-green-800 dark:text-green-300"},fe={class:"px-6 py-4 whitespace-nowrap"},he={class:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-blue-100 dark:bg-blue-900 text-blue-800 dark:text-blue-300"},we={class:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium space-x-2"},_e=["onClick"],$e=["onClick"],Ce=["onClick"],Re=A({__name:"RolesTab",props:{roles:{},permissionKey:{},loading:{type:Boolean}},emits:["open-role-modal","open-assignment-modal","refresh"],setup(p,{emit:m}){const g=m,{canCreate:x,canUpdate:n,canDelete:l}=W(),y=V(),b=async h=>{var t,s;if(confirm("Are you sure you want to delete this role?"))try{await y.deleteRole(h),_.success("Role deleted successfully"),g("refresh")}catch(r){_.error(((s=(t=r.response)==null?void 0:t.data)==null?void 0:s.message)||"Failed to delete role"),console.error(r)}};return(h,t)=>(o(),d("div",ae,[e("div",le,[t[2]||(t[2]=e("h2",{class:"text-lg font-semibold text-gray-900 dark:text-white"},"Roles Management",-1)),u(x)(p.permissionKey)?(o(),d("button",{key:0,onClick:t[0]||(t[0]=s=>g("open-role-modal")),class:"flex items-center space-x-2 px-4 py-2 bg-blue-600 dark:bg-blue-500 text-white rounded-lg hover:bg-blue-700 dark:hover:bg-blue-600 transition-colors"},[w(u(L),{size:18}),t[1]||(t[1]=e("span",{class:"text-sm"},"Add Role",-1))])):k("",!0)]),e("div",de,[e("div",ne,[e("table",ie,[t[5]||(t[5]=e("thead",{class:"bg-gray-50 dark:bg-gray-900"},[e("tr",null,[e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"},"Role Name"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"},"Description"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"},"Type"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"},"Permissions"),e("th",{class:"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"},"Actions")])],-1)),e("tbody",ce,[p.loading?(o(),d("tr",ue,[...t[3]||(t[3]=[e("td",{colspan:"5",class:"px-6 py-8 text-center text-gray-500 dark:text-gray-400"},[e("div",{class:"flex flex-col items-center"},[e("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 dark:border-blue-400 mb-2"}),C(" Loading roles... ")])],-1)])])):p.roles.length===0?(o(),d("tr",ge,[...t[4]||(t[4]=[e("td",{colspan:"5",class:"px-6 py-8 text-center text-gray-500 dark:text-gray-400"}," No roles found ",-1)])])):(o(!0),d(B,{key:2},T(p.roles,s=>{var r;return o(),d("tr",{key:s.id,class:"hover:bg-gray-50 dark:hover:bg-gray-700"},[e("td",ye,[e("div",xe,v(s.name),1)]),e("td",pe,[e("div",me,v(s.description||"-"),1)]),e("td",be,[s.is_system_role?(o(),d("span",ke," System ")):(o(),d("span",ve," Custom "))]),e("td",fe,[e("span",he,v(((r=s.permissions)==null?void 0:r.length)||0)+" permissions ",1)]),e("td",we,[e("button",{onClick:a=>g("open-assignment-modal",s),class:"text-purple-600 dark:text-purple-400 hover:text-purple-900 dark:hover:text-purple-300",title:"Assign Permissions"},[w(u(Y),{size:18})],8,_e),u(n)(p.permissionKey)&&!s.is_system_role?(o(),d("button",{key:0,onClick:a=>g("open-role-modal",s),class:"text-blue-600 dark:text-blue-400 hover:text-blue-900 dark:hover:text-blue-300",title:"Edit"},[w(u(ee),{size:18})],8,$e)):k("",!0),u(l)(p.permissionKey)&&!s.is_system_role?(o(),d("button",{key:1,onClick:a=>b(s.id),class:"text-red-600 dark:text-red-400 hover:text-red-900 dark:hover:text-red-300",title:"Delete"},[w(u(I),{size:18})],8,Ce)):k("",!0)])])}),128))])])])])]))}}),Me={class:"space-y-4"},Pe={class:"flex justify-between items-center"},Se={class:"bg-white dark:bg-gray-800 rounded-lg shadow overflow-hidden"},ze={class:"overflow-auto"},Ae={class:"min-w-full divide-y divide-gray-200 dark:divide-gray-700"},je={class:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700"},Ve={key:0},Ue={key:1},De={class:"px-6 py-4 whitespace-nowrap"},Be={class:"text-sm font-medium text-gray-900 dark:text-white"},Te={class:"px-6 py-4"},Ne={class:"text-sm text-gray-600 dark:text-gray-400"},Ke={class:"px-6 py-4"},Fe={class:"flex flex-wrap gap-2"},He={key:0,class:"px-2 py-1 inline-flex items-center text-xs leading-5 font-semibold rounded-full bg-green-100 dark:bg-green-900 text-green-800 dark:text-green-300"},Ee={key:1,class:"px-2 py-1 inline-flex items-center text-xs leading-5 font-semibold rounded-full bg-blue-100 dark:bg-blue-900 text-blue-800 dark:text-blue-300"},Oe={key:2,class:"px-2 py-1 inline-flex items-center text-xs leading-5 font-semibold rounded-full bg-yellow-100 dark:bg-yellow-900 text-yellow-800 dark:text-yellow-300"},qe={key:3,class:"px-2 py-1 inline-flex items-center text-xs leading-5 font-semibold rounded-full bg-red-100 dark:bg-red-900 text-red-800 dark:text-red-300"},Le={class:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium"},Ie=["onClick"],Xe=A({__name:"PermissionsTab",props:{permissions:{},permissionKey:{},loading:{type:Boolean}},emits:["open-permission-modal","refresh"],setup(p,{emit:m}){const g=p,x=m,{canCreate:n,canDelete:l}=W(),y=V(),b=$(()=>{const t={};return g.permissions.forEach(s=>{t[s.resource]||(t[s.resource]={resource:s.resource,description:s.description,actions:{}}),t[s.resource].actions[s.action]=s}),Object.values(t)}),h=async t=>{var s,r;if(confirm(`Are you sure you want to delete all permissions for "${t}"?`))try{const c=g.permissions.filter(i=>i.resource===t).map(i=>y.deletePermission(i.id));await Promise.all(c),_.success(`All permissions for "${t}" deleted successfully`),x("refresh")}catch(a){_.error(((r=(s=a.response)==null?void 0:s.data)==null?void 0:r.message)||"Failed to delete permissions"),console.error(a)}};return(t,s)=>(o(),d("div",Me,[e("div",Pe,[s[2]||(s[2]=e("h2",{class:"text-lg font-semibold text-gray-900 dark:text-white"},"Permissions Management",-1)),u(n)(p.permissionKey)?(o(),d("button",{key:0,onClick:s[0]||(s[0]=r=>x("open-permission-modal")),class:"flex items-center space-x-2 px-4 py-2 bg-blue-600 dark:bg-blue-500 text-white rounded-lg hover:bg-blue-700 dark:hover:bg-blue-600 transition-colors"},[w(u(L),{size:18}),s[1]||(s[1]=e("span",{class:"text-sm"},"Add Permission",-1))])):k("",!0)]),e("div",Se,[e("div",ze,[e("table",Ae,[s[9]||(s[9]=e("thead",{class:"bg-gray-50 dark:bg-gray-900"},[e("tr",null,[e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"},"Resource"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"},"Description"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"},"Actions"),e("th",{class:"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"},"Manage")])],-1)),e("tbody",je,[p.loading?(o(),d("tr",Ve,[...s[3]||(s[3]=[e("td",{colspan:"4",class:"px-6 py-8 text-center text-gray-500 dark:text-gray-400"},[e("div",{class:"flex flex-col items-center"},[e("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 dark:border-blue-400 mb-2"}),C(" Loading permissions... ")])],-1)])])):b.value.length===0?(o(),d("tr",Ue,[...s[4]||(s[4]=[e("td",{colspan:"4",class:"px-6 py-8 text-center text-gray-500 dark:text-gray-400"}," No permissions found ",-1)])])):(o(!0),d(B,{key:2},T(b.value,r=>(o(),d("tr",{key:r.resource,class:"hover:bg-gray-50 dark:hover:bg-gray-700"},[e("td",De,[e("div",Be,v(r.resource),1)]),e("td",Te,[e("div",Ne,v(r.description||"-"),1)]),e("td",Ke,[e("div",Fe,[r.actions.view?(o(),d("span",He,[w(u(D),{size:12,class:"mr-1"}),s[5]||(s[5]=C(" view ",-1))])):k("",!0),r.actions.create?(o(),d("span",Ee,[w(u(D),{size:12,class:"mr-1"}),s[6]||(s[6]=C(" create ",-1))])):k("",!0),r.actions.update?(o(),d("span",Oe,[w(u(D),{size:12,class:"mr-1"}),s[7]||(s[7]=C(" update ",-1))])):k("",!0),r.actions.delete?(o(),d("span",qe,[w(u(D),{size:12,class:"mr-1"}),s[8]||(s[8]=C(" delete ",-1))])):k("",!0)])]),e("td",Le,[u(l)(p.permissionKey)?(o(),d("button",{key:0,onClick:a=>h(r.resource),class:"text-red-600 dark:text-red-400 hover:text-red-900 dark:hover:text-red-300",title:"Delete all permissions for this resource"},[w(u(I),{size:18})],8,Ie)):k("",!0)])]))),128))])])])])]))}}),Ge={class:"fixed inset-0 bg-black bg-opacity-50 dark:bg-opacity-70 flex items-center justify-center z-50 p-4 !mt-0"},We={class:"bg-white dark:bg-gray-800 rounded-lg shadow-xl w-full max-w-md max-h-[90vh] overflow-hidden border border-gray-200 dark:border-gray-700"},Ye={class:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700"},Ze={class:"text-xl font-semibold text-gray-900 dark:text-gray-100"},Je={class:"text-sm text-gray-600 dark:text-gray-400 mt-1"},Qe=["disabled"],et={key:0,class:"absolute inset-0 bg-white dark:bg-gray-800 bg-opacity-75 dark:bg-opacity-75 flex items-center justify-center z-10 rounded-lg"},tt={class:"p-6 overflow-y-auto max-h-[calc(90vh-180px)] modal-scroll"},st={key:0,class:"flex items-center space-x-2"},rt={class:"flex justify-end gap-3 p-6 border-t border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-700/30"},ot=["disabled"],at=["disabled"],lt={key:0,class:"animate-spin h-4 w-4 text-white",fill:"none",viewBox:"0 0 24 24"},dt=A({__name:"RoleModal",props:{role:{}},emits:["close","saved"],setup(p,{emit:m}){const g=p,x=m,n=V(),l=z({name:"",description:"",is_system_role:!1}),y=$(()=>n.loading),b=$(()=>g.role!==void 0),h=$(()=>b.value?"Edit Role":"Add New Role"),t=$(()=>b.value?"Update role information":"Create a new role for access control"),s=$(()=>b.value?"Update Role":"Create Role");X(()=>g.role,c=>{c?l.value={id:c.id,name:c.name,description:c.description||"",is_system_role:c.is_system_role}:l.value={name:"",description:"",is_system_role:!1}},{immediate:!0});const r=()=>{x("close")},a=async()=>{var c,i;if(!l.value.name.trim()){_.error("Role name is required");return}try{const f={name:l.value.name,description:l.value.description||void 0,is_system_role:l.value.is_system_role};b.value&&l.value.id?(await n.updateRole(l.value.id,f),_.success("Role updated successfully")):(await n.createRole(f),_.success("Role created successfully")),x("saved")}catch(f){_.error(((i=(c=f.response)==null?void 0:c.data)==null?void 0:i.message)||"Failed to save role"),console.error(f)}};return(c,i)=>(o(),d("div",Ge,[e("div",We,[e("div",Ye,[e("div",null,[e("h2",Ze,v(h.value),1),e("p",Je,v(t.value),1)]),e("button",{onClick:r,class:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",disabled:y.value},[w(u(K),{size:20,class:"text-gray-500 dark:text-gray-400"})],8,Qe)]),y.value?(o(),d("div",et,[...i[3]||(i[3]=[e("div",{class:"flex flex-col items-center"},[e("svg",{class:"w-8 h-8 animate-spin text-gray-600 dark:text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})]),e("span",{class:"mt-2 text-sm text-gray-600 dark:text-gray-400"},"Saving role...")],-1)])])):k("",!0),e("div",tt,[e("form",{onSubmit:G(a,["prevent"]),class:"space-y-4"},[e("div",null,[i[4]||(i[4]=e("label",{for:"role-name",class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},[C(" Role Name "),e("span",{class:"text-red-500"},"*")],-1)),P(e("input",{id:"role-name","onUpdate:modelValue":i[0]||(i[0]=f=>l.value.name=f),type:"text",class:"w-full rounded-lg border border-gray-300 dark:border-gray-600 px-4 py-2.5 focus:border-gray-500 dark:focus:border-gray-400 focus:ring-2 focus:ring-gray-200 dark:focus:ring-gray-400/50 outline-none transition-colors bg-white dark:bg-gray-700 text-gray-900 dark:text-white",placeholder:"e.g., Project Manager",required:""},null,512),[[N,l.value.name]])]),e("div",null,[i[5]||(i[5]=e("label",{for:"role-description",class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"}," Description ",-1)),P(e("textarea",{id:"role-description","onUpdate:modelValue":i[1]||(i[1]=f=>l.value.description=f),rows:"3",class:"w-full rounded-lg border border-gray-300 dark:border-gray-600 px-4 py-2.5 focus:border-gray-500 dark:focus:border-gray-400 focus:ring-2 focus:ring-gray-200 dark:focus:ring-gray-400/50 outline-none transition-colors bg-white dark:bg-gray-700 text-gray-900 dark:text-white",placeholder:"Optional description..."},null,512),[[N,l.value.description]])]),b.value?k("",!0):(o(),d("div",st,[P(e("input",{"onUpdate:modelValue":i[2]||(i[2]=f=>l.value.is_system_role=f),type:"checkbox",id:"system-role",class:"h-4 w-4 text-blue-600 border-gray-300 dark:border-gray-600 rounded focus:ring-blue-500"},null,512),[[U,l.value.is_system_role]]),i[6]||(i[6]=e("label",{for:"system-role",class:"text-sm text-gray-700 dark:text-gray-300"}," System Role (cannot be edited/deleted) ",-1))]))],32)]),e("div",rt,[e("button",{onClick:r,class:"px-4 py-2.5 border border-gray-300 dark:border-gray-600 rounded-lg text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors text-sm font-medium disabled:opacity-50",disabled:y.value}," Cancel ",8,ot),e("button",{onClick:a,class:"px-4 py-2.5 bg-blue-600 dark:bg-blue-700 text-white rounded-lg hover:bg-blue-700 dark:hover:bg-blue-800 transition-colors flex items-center gap-2 text-sm font-medium disabled:opacity-50 disabled:cursor-not-allowed",disabled:y.value},[y.value?(o(),d("svg",lt,[...i[7]||(i[7]=[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)])])):(o(),S(u(F),{key:1,size:16})),e("span",null,v(s.value),1)],8,at)])])]))}}),nt={class:"fixed inset-0 bg-black bg-opacity-50 dark:bg-opacity-70 flex items-center justify-center z-50 p-4 !mt-0"},it={class:"bg-white dark:bg-gray-800 rounded-lg shadow-xl w-full max-w-md max-h-[90vh] overflow-hidden border border-gray-200 dark:border-gray-700"},ct={class:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700"},ut=["disabled"],gt={key:0,class:"absolute inset-0 bg-white dark:bg-gray-800 bg-opacity-75 dark:bg-opacity-75 flex items-center justify-center z-10 rounded-lg"},yt={class:"p-6 overflow-y-auto max-h-[calc(90vh-180px)] modal-scroll"},xt={class:"space-y-2"},pt={class:"flex items-center space-x-3 cursor-pointer p-3 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors border border-gray-200 dark:border-gray-600"},mt={class:"text-xs text-gray-500 dark:text-gray-400 font-mono bg-gray-100 dark:bg-gray-800 px-2 py-1 rounded"},bt={class:"flex items-center space-x-3 cursor-pointer p-3 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors border border-gray-200 dark:border-gray-600"},kt={class:"text-xs text-gray-500 dark:text-gray-400 font-mono bg-gray-100 dark:bg-gray-800 px-2 py-1 rounded"},vt={class:"flex items-center space-x-3 cursor-pointer p-3 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors border border-gray-200 dark:border-gray-600"},ft={class:"text-xs text-gray-500 dark:text-gray-400 font-mono bg-gray-100 dark:bg-gray-800 px-2 py-1 rounded"},ht={class:"flex items-center space-x-3 cursor-pointer p-3 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors border border-gray-200 dark:border-gray-600"},wt={class:"text-xs text-gray-500 dark:text-gray-400 font-mono bg-gray-100 dark:bg-gray-800 px-2 py-1 rounded"},_t={class:"flex justify-end gap-3 p-6 border-t border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-700/30"},$t=["disabled"],Ct=["disabled"],Rt={key:0,class:"animate-spin h-4 w-4 text-white",fill:"none",viewBox:"0 0 24 24"},Mt=A({__name:"PermissionModal",emits:["close","saved"],setup(p,{emit:m}){const g=m,x=V(),n=z({resource:"",description:"",actions:{view:!1,create:!1,update:!1,delete:!1}}),l=$(()=>x.loading),y=()=>{g("close")},b=async()=>{var t,s;if(!n.value.resource.trim()){_.error("Resource name is required");return}const h=Object.entries(n.value.actions).filter(([r,a])=>a).map(([r])=>r);if(h.length===0){_.error("Please select at least one action");return}try{const r=h.map(a=>{const c={resource:n.value.resource,action:a,description:n.value.description||void 0};return x.createPermission(c)});await Promise.all(r),_.success(`${h.length} permission(s) created successfully`),g("saved")}catch(r){_.error(((s=(t=r.response)==null?void 0:t.data)==null?void 0:s.message)||"Failed to create permissions"),console.error(r)}};return(h,t)=>(o(),d("div",nt,[e("div",it,[e("div",ct,[t[6]||(t[6]=e("div",null,[e("h2",{class:"text-xl font-semibold text-gray-900 dark:text-gray-100"}," Add New Permissions "),e("p",{class:"text-sm text-gray-600 dark:text-gray-400 mt-1"}," Create permissions for a resource ")],-1)),e("button",{onClick:y,class:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",disabled:l.value},[w(u(K),{size:20,class:"text-gray-500 dark:text-gray-400"})],8,ut)]),l.value?(o(),d("div",gt,[...t[7]||(t[7]=[e("div",{class:"flex flex-col items-center"},[e("svg",{class:"w-8 h-8 animate-spin text-gray-600 dark:text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})]),e("span",{class:"mt-2 text-sm text-gray-600 dark:text-gray-400"},"Creating permissions...")],-1)])])):k("",!0),e("div",yt,[e("form",{onSubmit:G(b,["prevent"]),class:"space-y-4"},[e("div",null,[t[8]||(t[8]=e("label",{for:"resource",class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},[C(" Resource Name "),e("span",{class:"text-red-500"},"*")],-1)),P(e("input",{id:"resource","onUpdate:modelValue":t[0]||(t[0]=s=>n.value.resource=s),type:"text",class:"w-full rounded-lg border border-gray-300 dark:border-gray-600 px-4 py-2.5 focus:border-gray-500 dark:focus:border-gray-400 focus:ring-2 focus:ring-gray-200 dark:focus:ring-gray-400/50 outline-none transition-colors bg-white dark:bg-gray-700 text-gray-900 dark:text-white",placeholder:"e.g., projects, users, reports",required:""},null,512),[[N,n.value.resource]]),t[9]||(t[9]=e("p",{class:"text-xs text-gray-500 dark:text-gray-400 mt-1"},"Use lowercase, no spaces (use underscores)",-1))]),e("div",null,[t[10]||(t[10]=e("label",{for:"description",class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"}," Description ",-1)),P(e("input",{id:"description","onUpdate:modelValue":t[1]||(t[1]=s=>n.value.description=s),type:"text",class:"w-full rounded-lg border border-gray-300 dark:border-gray-600 px-4 py-2.5 focus:border-gray-500 dark:focus:border-gray-400 focus:ring-2 focus:ring-gray-200 dark:focus:ring-gray-400/50 outline-none transition-colors bg-white dark:bg-gray-700 text-gray-900 dark:text-white",placeholder:"e.g., Project Management, User Management"},null,512),[[N,n.value.description]])]),e("div",null,[t[15]||(t[15]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"},[C(" Select Actions "),e("span",{class:"text-red-500"},"*")],-1)),e("div",xt,[e("label",pt,[P(e("input",{"onUpdate:modelValue":t[2]||(t[2]=s=>n.value.actions.view=s),type:"checkbox",class:"h-4 w-4 text-green-600 border-gray-300 dark:border-gray-600 rounded focus:ring-green-500"},null,512),[[U,n.value.actions.view]]),t[11]||(t[11]=e("div",{class:"flex-1"},[e("span",{class:"text-sm font-medium text-gray-700 dark:text-gray-300"},"View / Read")],-1)),e("span",mt,v(n.value.resource||"resource")+".view ",1)]),e("label",bt,[P(e("input",{"onUpdate:modelValue":t[3]||(t[3]=s=>n.value.actions.create=s),type:"checkbox",class:"h-4 w-4 text-blue-600 border-gray-300 dark:border-gray-600 rounded focus:ring-blue-500"},null,512),[[U,n.value.actions.create]]),t[12]||(t[12]=e("div",{class:"flex-1"},[e("span",{class:"text-sm font-medium text-gray-700 dark:text-gray-300"},"Create / Add")],-1)),e("span",kt,v(n.value.resource||"resource")+".create ",1)]),e("label",vt,[P(e("input",{"onUpdate:modelValue":t[4]||(t[4]=s=>n.value.actions.update=s),type:"checkbox",class:"h-4 w-4 text-yellow-600 border-gray-300 dark:border-gray-600 rounded focus:ring-yellow-500"},null,512),[[U,n.value.actions.update]]),t[13]||(t[13]=e("div",{class:"flex-1"},[e("span",{class:"text-sm font-medium text-gray-700 dark:text-gray-300"},"Update / Edit")],-1)),e("span",ft,v(n.value.resource||"resource")+".update ",1)]),e("label",ht,[P(e("input",{"onUpdate:modelValue":t[5]||(t[5]=s=>n.value.actions.delete=s),type:"checkbox",class:"h-4 w-4 text-red-600 border-gray-300 dark:border-gray-600 rounded focus:ring-red-500"},null,512),[[U,n.value.actions.delete]]),t[14]||(t[14]=e("div",{class:"flex-1"},[e("span",{class:"text-sm font-medium text-gray-700 dark:text-gray-300"},"Delete / Remove")],-1)),e("span",wt,v(n.value.resource||"resource")+".delete ",1)])])])],32)]),e("div",_t,[e("button",{onClick:y,class:"px-4 py-2.5 border border-gray-300 dark:border-gray-600 rounded-lg text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors text-sm font-medium disabled:opacity-50",disabled:l.value}," Cancel ",8,$t),e("button",{onClick:b,class:"px-4 py-2.5 bg-blue-600 dark:bg-blue-700 text-white rounded-lg hover:bg-blue-700 dark:hover:bg-blue-800 transition-colors flex items-center gap-2 text-sm font-medium disabled:opacity-50 disabled:cursor-not-allowed",disabled:l.value},[l.value?(o(),d("svg",Rt,[...t[16]||(t[16]=[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)])])):(o(),S(u(F),{key:1,size:16})),t[17]||(t[17]=e("span",null,"Create Permissions",-1))],8,Ct)])])]))}}),Pt={class:"fixed inset-0 bg-black bg-opacity-50 dark:bg-opacity-70 flex items-center justify-center z-50 p-4 !mt-0"},St={class:"bg-white dark:bg-gray-800 rounded-lg shadow-xl w-full max-w-3xl max-h-[90vh] overflow-hidden border border-gray-200 dark:border-gray-700"},zt={class:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700"},At={class:"text-sm text-gray-600 dark:text-gray-400 mt-1"},jt={class:"font-medium text-blue-600 dark:text-blue-400"},Vt=["disabled"],Ut={key:0,class:"absolute inset-0 bg-white dark:bg-gray-800 bg-opacity-75 dark:bg-opacity-75 flex items-center justify-center z-10 rounded-lg"},Dt={class:"p-6 overflow-y-auto max-h-[calc(90vh-220px)] modal-scroll"},Bt={class:"space-y-4"},Tt={class:"text-sm font-semibold text-gray-900 dark:text-white mb-3 capitalize flex items-center"},Nt={class:"grid grid-cols-1 md:grid-cols-2 gap-3"},Kt=["id","checked","onChange"],Ft=["for"],Ht={class:"font-medium capitalize"},Et={key:0,class:"block text-xs text-gray-500 dark:text-gray-400 mt-0.5"},Ot={class:"flex justify-between items-center gap-3 p-6 border-t border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-700/30"},qt={class:"text-sm text-gray-600 dark:text-gray-400"},Lt={class:"font-medium text-gray-900 dark:text-white"},It={class:"flex gap-3"},Xt=["disabled"],Gt=["disabled"],Wt={key:0,class:"animate-spin h-4 w-4 text-white",fill:"none",viewBox:"0 0 24 24"},Yt=A({__name:"AssignmentModal",props:{role:{},permissions:{}},emits:["close","saved"],setup(p,{emit:m}){const g=p,x=m,n=V(),l=z(new Set),y=$(()=>n.loading),b=$(()=>{const r={};return g.permissions.forEach(a=>{r[a.resource]||(r[a.resource]=[]),r[a.resource].push(a)}),r});X(()=>g.role,r=>{var a;r?l.value=new Set(((a=r.permissions)==null?void 0:a.map(c=>c.id))||[]):l.value=new Set},{immediate:!0});const h=r=>{l.value.has(r)?l.value.delete(r):l.value.add(r)},t=()=>{x("close")},s=async()=>{var r,a;if(g.role)try{const c=Array.from(l.value);await n.syncPermissions(g.role.id,c),_.success("Permissions updated successfully"),x("saved")}catch(c){_.error(((a=(r=c.response)==null?void 0:r.data)==null?void 0:a.message)||"Failed to update permissions"),console.error(c)}};return(r,a)=>{var c;return o(),d("div",Pt,[e("div",St,[e("div",zt,[e("div",null,[a[1]||(a[1]=e("h2",{class:"text-xl font-semibold text-gray-900 dark:text-gray-100"}," Assign Permissions ",-1)),e("p",At,[a[0]||(a[0]=C(" Manage permissions for ",-1)),e("span",jt,v((c=p.role)==null?void 0:c.name),1)])]),e("button",{onClick:t,class:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",disabled:y.value},[w(u(K),{size:20,class:"text-gray-500 dark:text-gray-400"})],8,Vt)]),y.value?(o(),d("div",Ut,[...a[2]||(a[2]=[e("div",{class:"flex flex-col items-center"},[e("svg",{class:"w-8 h-8 animate-spin text-gray-600 dark:text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})]),e("span",{class:"mt-2 text-sm text-gray-600 dark:text-gray-400"},"Updating permissions...")],-1)])])):k("",!0),e("div",Dt,[e("div",Bt,[(o(!0),d(B,null,T(b.value,(i,f)=>(o(),d("div",{key:f,class:"border border-gray-200 dark:border-gray-700 rounded-lg p-4 bg-gray-50 dark:bg-gray-700/50"},[e("h4",Tt,[a[3]||(a[3]=e("span",{class:"w-2 h-2 bg-blue-500 rounded-full mr-2"},null,-1)),C(" "+v(f),1)]),e("div",Nt,[(o(!0),d(B,null,T(i,R=>(o(),d("div",{key:R.id,class:"flex items-start space-x-3 p-2 rounded hover:bg-white dark:hover:bg-gray-700 transition-colors"},[e("input",{type:"checkbox",id:`perm-${R.id}`,checked:l.value.has(R.id),onChange:H=>h(R.id),class:"h-4 w-4 text-blue-600 border-gray-300 dark:border-gray-600 rounded focus:ring-blue-500 mt-0.5"},null,40,Kt),e("label",{for:`perm-${R.id}`,class:"text-sm text-gray-700 dark:text-gray-300 flex-1 cursor-pointer"},[e("span",Ht,v(R.action),1),R.description?(o(),d("span",Et,v(R.description),1)):k("",!0)],8,Ft)]))),128))])]))),128))])]),e("div",Ot,[e("p",qt,[e("span",Lt,v(l.value.size),1),a[4]||(a[4]=C(" permission(s) selected ",-1))]),e("div",It,[e("button",{onClick:t,class:"px-4 py-2.5 border border-gray-300 dark:border-gray-600 rounded-lg text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors text-sm font-medium disabled:opacity-50",disabled:y.value}," Cancel ",8,Xt),e("button",{onClick:s,class:"px-4 py-2.5 bg-blue-600 dark:bg-blue-700 text-white rounded-lg hover:bg-blue-700 dark:hover:bg-blue-800 transition-colors flex items-center gap-2 text-sm font-medium disabled:opacity-50 disabled:cursor-not-allowed",disabled:y.value},[y.value?(o(),d("svg",Wt,[...a[5]||(a[5]=[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)])])):(o(),S(u(F),{key:1,size:16})),a[6]||(a[6]=e("span",null,"Save Permissions",-1))],8,Gt)])])])])}}}),Zt={class:"space-y-6 p-0 md:p-6"},Jt={class:"border-b border-gray-200 dark:border-gray-700"},Qt={class:"flex space-x-8"},es={class:"flex items-center space-x-2"},ts={class:"flex items-center space-x-2"},q="access_settings",ss=A({__name:"index",setup(p){const m=V(),g=$(()=>m.loading),x=z("roles"),n=z(!1),l=z(!1),y=z(!1),b=z(void 0),h=$(()=>m.roles),t=$(()=>m.permissions),s=$(()=>m.selectedRole),r=async()=>{try{await Promise.all([m.fetchRoles(),m.fetchPermissions()])}catch(j){_.error("Failed to fetch data"),console.error(j)}},a=j=>{b.value=j,n.value=!0},c=()=>{n.value=!1,b.value=void 0},i=()=>{c(),r()},f=()=>{l.value=!0},R=()=>{l.value=!1},H=()=>{R(),r()},Z=j=>{m.setSelectedRole(j),y.value=!0},E=()=>{y.value=!1,m.setSelectedRole(null)},J=()=>{E(),r()};return se(()=>{r()}),re(()=>{r()}),(j,M)=>(o(),d("div",Zt,[M[4]||(M[4]=e("div",{class:"flex items-center justify-between"},[e("div",null,[e("h1",{class:"text-2xl font-bold text-gray-900 dark:text-white"},"Access Settings"),e("p",{class:"text-sm text-gray-600 dark:text-gray-400 mt-1"},"Manage roles, permissions, and access control")])],-1)),e("div",Jt,[e("nav",Qt,[e("button",{onClick:M[0]||(M[0]=Q=>x.value="roles"),class:O(["py-4 px-1 border-b-2 font-medium text-sm transition-colors",x.value==="roles"?"border-blue-500 text-blue-600 dark:text-blue-400":"border-transparent text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 hover:border-gray-300 dark:hover:border-gray-600"])},[e("div",es,[w(u(oe),{size:18}),M[2]||(M[2]=e("span",null,"Roles",-1))])],2),e("button",{onClick:M[1]||(M[1]=Q=>x.value="permissions"),class:O(["py-4 px-1 border-b-2 font-medium text-sm transition-colors",x.value==="permissions"?"border-blue-500 text-blue-600 dark:text-blue-400":"border-transparent text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 hover:border-gray-300 dark:hover:border-gray-600"])},[e("div",ts,[w(u(Y),{size:18}),M[3]||(M[3]=e("span",null,"Permissions",-1))])],2)])]),x.value==="roles"?(o(),S(Re,{key:0,roles:h.value,loading:g.value,"permission-key":q,onOpenRoleModal:a,onOpenAssignmentModal:Z,onRefresh:r},null,8,["roles","loading"])):k("",!0),x.value==="permissions"?(o(),S(Xe,{key:1,permissions:t.value,loading:g.value,"permission-key":q,onOpenPermissionModal:f,onRefresh:r},null,8,["permissions","loading"])):k("",!0),n.value?(o(),S(dt,{key:2,role:b.value,onClose:c,onSaved:i},null,8,["role"])):k("",!0),l.value?(o(),S(Mt,{key:3,onClose:R,onSaved:H})):k("",!0),y.value?(o(),S(Yt,{key:4,role:s.value,permissions:t.value,onClose:E,onSaved:J},null,8,["role","permissions"])):k("",!0)]))}}),ds=A({__name:"AccessSettings",setup(p){return(m,g)=>(o(),S(ss))}});export{ds as default};
