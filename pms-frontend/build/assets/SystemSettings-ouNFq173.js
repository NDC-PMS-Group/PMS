import{c as G,d as D,$ as N,a0 as X,l as Y,o as r,f as a,b as s,e as l,h as b,v as z,a1 as $,i as V,g as i,w as q,a2 as K,a3 as P,F as U,m as j,a as T,D as A,t as k,x as v,R as H,y as w,a4 as J,n as S,j as Q,V as f,_ as W}from"./index-BGKEJEuu.js";import{u as Z,S as ee}from"./usePermission-CYqkqYTp.js";import{S as F}from"./settings-DtUEWWXi.js";import{S as se}from"./shield-DVI2KD-N.js";/**
 * @license lucide-vue-next v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const te=G("XCircleIcon",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]),re={class:"p-0 md:p-6 space-y-6"},ae={class:"flex items-center justify-between"},oe={class:"flex items-center gap-3"},le=["disabled"],de=["disabled"],ne={key:0,class:"bg-green-50 border border-green-200 rounded-lg p-4 flex items-center gap-3"},ie={key:0,class:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-8"},ce={key:1,class:"space-y-6"},ue={class:"flex items-center gap-3"},ye={class:"text-lg font-semibold capitalize"},be={class:"p-6 space-y-6"},pe={class:"flex items-start justify-between gap-6"},fe={class:"flex-1"},me=["for"],ge={key:0,class:"text-sm text-gray-600"},ve={class:"w-64"},xe={key:0,class:"flex items-center justify-end"},he={class:"relative inline-flex items-center cursor-pointer"},_e=["id","onUpdate:modelValue","disabled"],ke={key:1,class:"flex items-center gap-2"},we=["id","onUpdate:modelValue","disabled"],Se={key:0,class:"text-sm text-gray-600 whitespace-nowrap"},Ce=["id","onUpdate:modelValue","disabled"],ze=["id","onUpdate:modelValue","disabled"],Ve={key:0,class:"mt-2 flex items-center gap-2 text-sm text-amber-600"},Ue={key:2,class:"bg-yellow-50 border border-yellow-200 rounded-lg p-4 flex items-center gap-3"},c="system_settings",je=D({__name:"index",setup(R){const p=N(),{settings:y,loading:x}=X(p),{canUpdate:n}=Z(),d=S({}),h=S(!1),m=S(!1),_=()=>{const o={};Object.values(y.value).flat().forEach(e=>{o[e.key]=e.value}),d.value=o},C=Q(()=>Object.values(y.value).flat().some(o=>d.value[o.key]!==o.value)),B=async()=>{if(!n(c)){f.error("You do not have permission to update settings");return}h.value=!0,m.value=!1;try{const o=Object.values(y.value).flat().filter(e=>d.value[e.key]!==e.value).map(e=>({key:e.key,value:d.value[e.key]}));if(o.length===0){f.success("No changes to save");return}await p.updateSettings(o),m.value=!0,setTimeout(()=>{m.value=!1},3e3),f.success("Settings saved successfully")}catch{f.error("Failed to save settings")}finally{h.value=!1}},I=()=>{_()},O=async()=>{try{await p.fetchSettings(),_()}catch{f.error("Failed to refresh settings")}},L=o=>({security:se,general:F})[o]||F,M=o=>({security:"text-red-600 bg-red-50 border-red-200",general:"text-blue-600 bg-blue-50 border-blue-200"})[o]||"text-gray-600 bg-gray-50 border-gray-200";return Y(async()=>{try{await p.initialize(),_()}catch(o){console.error("Failed to initialize:",o)}}),(o,e)=>(r(),a("div",re,[s("div",ae,[e[2]||(e[2]=s("div",null,[s("h1",{class:"text-2xl font-bold text-gray-900"},"System Settings"),s("p",{class:"text-sm text-gray-600 mt-1"},"Configure system-wide settings and preferences")],-1)),s("div",oe,[s("button",{onClick:O,disabled:l(x),class:"px-4 py-2 bg-white border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 flex items-center gap-2 disabled:opacity-50"},[b(l($),{size:16,class:z({"animate-spin":l(x)})},null,8,["class"]),e[0]||(e[0]=V(" Refresh ",-1))],8,le),l(n)(c)&&C.value?(r(),a("button",{key:0,onClick:I,class:"px-4 py-2 bg-white border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50"}," Reset Changes ")):i("",!0),l(n)(c)?(r(),a("button",{key:1,onClick:B,disabled:h.value||!C.value,class:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed"},[b(l(ee),{size:16}),e[1]||(e[1]=V(" Save Changes ",-1))],8,de)):i("",!0)])]),b(P,{name:"fade"},{default:q(()=>[m.value?(r(),a("div",ne,[b(l(K),{size:20,class:"text-green-600"}),e[3]||(e[3]=s("span",{class:"text-green-800 font-medium"},"Settings saved successfully!",-1))])):i("",!0)]),_:1}),l(x)&&Object.keys(l(y)).length===0?(r(),a("div",ie,[...e[4]||(e[4]=[s("div",{class:"flex flex-col items-center justify-center"},[s("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 dark:border-blue-400 mb-2"}),s("p",{class:"text-gray-500 dark:text-gray-400"},"Loading settings...")],-1)])])):(r(),a("div",ce,[(r(!0),a(U,null,j(l(y),(E,g)=>(r(),a("div",{key:g,class:"bg-white rounded-lg border border-gray-200 overflow-hidden"},[s("div",{class:z([M(g),"px-6 py-4 border-b"])},[s("div",ue,[(r(),T(A(L(g)),{size:24})),s("div",null,[s("h2",ye,k(g)+" Settings",1)])])],2),s("div",be,[(r(!0),a(U,null,j(E,t=>(r(),a("div",{key:t.key,class:"border-b border-gray-100 pb-6 last:border-b-0 last:pb-0"},[s("div",pe,[s("div",fe,[s("label",{for:t.key,class:"block text-sm font-medium text-gray-900 mb-1"},k(t.label),9,me),t.description?(r(),a("p",ge,k(t.description),1)):i("",!0)]),s("div",ve,[t.type==="boolean"?(r(),a("div",xe,[s("label",he,[v(s("input",{id:t.key,"onUpdate:modelValue":u=>d.value[t.key]=u,type:"checkbox",class:"sr-only peer",disabled:!l(n)(c)},null,8,_e),[[H,d.value[t.key]]]),e[5]||(e[5]=s("div",{class:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"},null,-1))])])):t.type==="integer"?(r(),a("div",ke,[v(s("input",{id:t.key,"onUpdate:modelValue":u=>d.value[t.key]=u,type:"number",min:"1",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",disabled:!l(n)(c)},null,8,we),[[w,d.value[t.key],void 0,{number:!0}]]),t.key==="session_timeout_minutes"?(r(),a("span",Se," minutes ")):i("",!0)])):t.type==="string"?v((r(),a("input",{key:2,id:t.key,"onUpdate:modelValue":u=>d.value[t.key]=u,type:"text",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",disabled:!l(n)(c)},null,8,Ce)),[[w,d.value[t.key]]]):t.type==="float"?v((r(),a("input",{key:3,id:t.key,"onUpdate:modelValue":u=>d.value[t.key]=u,type:"number",step:"0.01",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",disabled:!l(n)(c)},null,8,ze)),[[w,d.value[t.key],void 0,{number:!0}]]):i("",!0)])]),d.value[t.key]!==t.value?(r(),a("div",Ve,[b(l(J),{size:14}),e[6]||(e[6]=s("span",null,"Unsaved changes",-1))])):i("",!0)]))),128))])]))),128))])),l(n)(c)?i("",!0):(r(),a("div",Ue,[b(l(te),{size:20,class:"text-yellow-600"}),e[7]||(e[7]=s("span",{class:"text-yellow-800"},"You do not have permission to modify system settings. Contact your administrator.",-1))]))]))}}),Fe=W(je,[["__scopeId","data-v-45d6095c"]]),Ie=D({__name:"SystemSettings",setup(R){return(p,y)=>(r(),T(Fe))}});export{Ie as default};
